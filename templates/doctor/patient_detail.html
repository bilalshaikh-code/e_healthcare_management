{% extends "doctor/base.html" %}
{% load static %}

{% block title %}Patient Details - {{ patient.full_name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/doctor.css' %}">
<style>
    .profile-card {
        background: #fff;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    .profile-card img {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 50%;
        border: 4px solid #008080;
        margin-bottom: 15px;
    }
    .appointment-badge {
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 0.85rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="topbar">
            <h2>Patient Details</h2>
            <a href="{% url 'doctor_patients' %}" class="btn btn-outline-primary btn-sm">‚Üê Back to Patients</a>
        </div>

        <div class="row mt-4">
            <div class="col-lg-4">
                <div class="profile-card text-center">
                    <img src="{{ patient.profile_image.url if patient.profile_image else '/static/img/default-avatar.png' }}" alt="{{ patient.full_name }}">
                    <h4>{{ patient.full_name }}</h4>
                    <p>{{ patient.email }}</p>
                    <p>{{ patient.mobile_number }}</p>
                    <p>{{ patient.address }}</p>
                </div>
            </div>

            <div class="col-lg-8">
                <div class="card p-3 mb-3">
                    <h5>Appointment History</h5>
                    <div class="table-responsive mt-2">
                        <table class="table table-striped table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Date</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for appt in appointments %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ appt.date|date:"M d, Y" }}</td>
                                    <td>{{ appt.time|time:"H:i" }}</td>
                                    <td>
                                        {% if appt.status == 'Pending' %}
                                            <span class="badge bg-warning text-dark appointment-badge">{{ appt.status }}</span>
                                        {% elif appt.status == 'Completed' %}
                                            <span class="badge bg-success appointment-badge">{{ appt.status }}</span>
                                        {% else %}
                                            <span class="badge bg-danger appointment-badge">{{ appt.status }}</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ appt.notes|default:"-" }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">No appointments found</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card p-3">
                    <h5>Medical Notes</h5>
                    {% if patient_notes %}
                        <ul>
                            {% for note in patient_notes %}
                                <li>{{ note.created_at|date:"M d, Y" }} - {{ note.content }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p>No medical notes available.</p>
                    {% endif %}
                </div>
            </div>
        </div>
{% endblock %}
