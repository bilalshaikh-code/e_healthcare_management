{% extends "base/base.html" %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Doctor Registration - HealthPlus Hospital{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/auth.css' %}">
{% endblock %}

{% block content %}
<div class="auth-bg">
    <div class="auth-card">
        <!-- Heading -->
        <h2 class="mt-3 text-primary fw-bold">Doctor Registration</h2>
        <p class="text-muted mb-0">Join our medical team at HealthPlus Hospital</p>
        <span class="badge-doctor">For Doctors & Specialists Only</span>

        <!-- Messages -->
        {% if messages %}
            {% for message in messages %}
                <div class="error-message">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <!-- Doctor Registration Form -->
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Profile Photo -->
            <div class="text-center mb-4">
                <img src="{% static 'img/default-avatar.png' %}" id="profilePreview" class="profile-preview">
                <label class="btn btn-outline-primary mb-3 mt-2">
                    <i class="fa fa-camera"></i> Upload Photo
                    <input type="file" name="{{ form.image.name }}" accept="image/*" style="display:none;" onchange="previewImage(event)">
                </label>
                {% if form.image.help_text %}
                    <small class="d-block text-muted mt-2">{{ form.image.help_text }}</small>
                {% else %}
                    <small class="d-block text-muted mb-3">Max 2MB • JPG/PNG</small>
                {% endif %}
            </div>

            <!-- Form Fields -->
            {% for field in form %}
                {% if field.name != "image" %}
                    <div class="mb-3 text-start">
                        <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                        {{ field|add_class:"form-control form-control-lg" }}
                        {% if field.help_text %}
                            <small class="form-text text-muted">{{ field.help_text }}</small>
                        {% endif %}
                        {% for error in field.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endfor %}

            <!-- Agreement Checkbox -->
            <div class="form-check mt-4 text-start">
                <input class="form-check-input" type="checkbox" id="agree" required>
                <label class="form-check-label text-muted">
                    I confirm that I am a licensed medical practitioner and agree to verification.
                </label>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-auth btn-lg w-100 text-white mt-4">
                Submit for Approval
            </button>

            <!-- Info & Back to Login -->
            <div class="text-center mt-4">
                <p class="text-muted">
                    Your account will be activated after admin verification (usually within 24 hours).
                </p>
                <a href="{% url 'signin' %}" class="text-primary">← Back to Login</a>
            </div>
        </form>
    </div>
</div>

<!-- JS for Profile Preview -->
<script>
function previewImage(event) {
    const reader = new FileReader();
    reader.onload = function(){
        document.getElementById('profilePreview').src = reader.result;
    }
    reader.readAsDataURL(event.target.files[0]);
}
</script>
{% endblock %}
